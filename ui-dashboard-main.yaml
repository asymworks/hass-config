###############################################################################
# Button Card Templates

button_card_templates:
  
  # Default Button (148 x 148)
  default:
    tap_action:
      action: toggle
    hold_action:
      action: more-info
    show_state: true
    size: 30%
    state:
      - styles:
          card:
            - filter: opacity(50%)
          icon:
            - filter: grayscale(100%)
        value: 'off'
      - styles:
          card:
            - filter: opacity(25%)
          icon:
            - filter: grayscale(100%)
        value: unavailable
    styles:
      card: 
        - height: 148px
      grid:
        - grid-template-areas: '"i" "n" "s"'
        - grid-template-columns: 1fr
        - grid-template-rows: 1fr min-content min-content
      img_cell:
        - justify-content: start
        - margin-left: 20px
        - margin-bottom: 25px
      name:
        - justify-self: start
        - margin-left: 10px
      state:
        - justify-self: start
        - margin-left: 10px
        - font-weight: lighter

  # Scene Button (148 x 20)
  scene_button:
    tap_action:
      action: call-service
      service: script.living_room_scene
      service_data: 
        scene_id: '[[[ return entity.entity_id ]]]'
        transition: 3
    show_icon: false
    show_state: false
    styles:
      card:
        - height: 32px
      grid:
        - grid-template-areas: '"n"'
        - grid-template-columns: 1fr
        - grid-template-rows: 1fr
      name:
        - justify-self: start
        - margin-left: 10px
        - text-size: 75%

  # Sensor Card (148 x 148)
  sensor:
    show_state: true
    size: 30%
    styles:
      card: 
        - height: 148px
      grid:
        - grid-template-areas: '"i" "n" "s"'
        - grid-template-columns: 1fr
        - grid-template-rows: 1fr min-content min-content
      img_cell:
        - margin-bottom: 25px
      name:
        - justify-self: start
        - margin-left: 10px
      state:
        - justify-self: start
        - margin-left: 10px
        - font-weight: lighter

  # Temperature Card (148 x 148)
  temperature:
    label: Temperature
    show_label: true
    show_state: true
    size: 70%
    styles:
      card: 
        - height: 148px
      grid:
        - grid-template-areas: '"i s" "n n" "l l"'
        - grid-template-columns: 1fr 2fr
        - grid-template-rows: 1fr min-content
      img_cell:
        - margin-bottom: 25px
      label:
        - justify-self: start
        - margin-left: 10px
        - font-weight: lighter
      name:
        - justify-self: start
        - margin-left: 10px
      state:
        - margin-bottom: 30px
        - margin-right: 40px
        - font-size: x-large

  # Title Card
  title:
    show_icon: false
    show_name: true
    show_state: false
    styles:
      card:
        - width: 300px
        - height: 60px
        - background: none
        - box-shadow: none
        - padding-top: 10px
      name:
        - justify-self: start
        - margin-left: 10px
        - font-weight: lighter
        - font-size: x-large

  # Title Link Card
  title_link:
    show_icon: false
    show_name: true
    show_state: false
    styles:
      card:
        - width: 150px
        - height: 60px
        - background: none
        - box-shadow: none
        - padding-top: 10px
      name:
        - justify-self: start
        - margin-left: 10px
        - font-size: x-large
        - color: var(--primary-color)

  # Weather Card (212 x 148)
  weather:
    label: '[[[ return `${entity.attributes.temperature}Â°F` ]]]'
    show_label: true
    show_state: true
    size: 60%
    state:
      - icon: 'mdi:weather-night'
        value: clear-night
      - icon: 'mdi:weather-cloudy'
        value: cloudy
      - icon: 'mdi:weather-fog'
        value: fog
      - icon: 'mdi:weather-hail'
        value: hail
      - icon: 'mdi:weather-lightning'
        value: lightning
      - icon: 'mdi:weather-lightning-rainy'
        value: lightning-rainy
      - icon: 'mdi:weather-partly-cloudy'
        value: partlycloudy
      - icon: 'mdi:weather-pouring'
        value: pouring
      - icon: 'mdi:weather-rainy'
        value: rainy
      - icon: 'mdi:weather-snowy'
        value: snowy
      - icon: 'mdi:weather-snowy-rainy'
        value: snowy-rainy
      - icon: 'mdi:weather-sunny'
        value: sunny
      - icon: 'mdi:weather-windy'
        value: windy
      - icon: 'mdi:weather-windy-variant'
        value: windy-variant
      - icon: 'mdi:weather-cloudy-alert'
        value: exceptional
    styles:
      card:
        - height: 148px
      grid:
        - grid-template-areas: '"i l rh" "n n aqi_index" "s s aqi_level"'
        - grid-template-columns: 1fr 1fr 1fr
        - grid-template-rows: 1fr min-content min-content
      img_cell:
        - align-content: start
        - justify-content: start
        - margin-left: 25px
      label:
        - justify-self: start
        - font-size: 180%
      name:
        - justify-self: start
        - margin-left: 10px
      state:
        - justify-self: start
        - margin-left: 10px
        - margin-bottom: '-6px'
        - font-weight: lighter
      custom_fields:
        rh:
          - justify-self: start
          - margin-left: 4px
          - font-size: 180%
        aqi_index:
          - justify-self: end
          - margin-right: '12px'
        aqi_level:
          - justify-self: end
          - margin-bottom: '-6px'
          - margin-right: '12px'
          - font-weight: lighter
    custom_fields:
      rh: '[[[ return `${entity.attributes.humidity}%` ]]]'
      aqi_index: >
        [[[ return `AQI: ${states["sensor.airnow_aqi"].state}` ]]]
      aqi_level: >
        [[[ return `${states["sensor.airnow_aqi"].attributes.description}` ]]]

title: Living Room Dashboard
views:
  - title: Dashboard
    type: custom:grid-layout
    path: dashboard
    theme: dark-mode
    panel: true
    layout:
      grid-template-columns: repeat(14, 78px)
      grid-template-rows: repeat(7, 78px)
    cards:
      - type: custom:button-card
        view_layout:
          grid-column: 3 / 7
          grid-row: 1 / 2
        name: Living Room Overview
        template: title

      - type: custom:button-card
        view_layout:
          grid-column: 7 / 9
          grid-row: 1 / 2
        name: Scenes
        template: title_link
        tap_action:
          action: navigate
          navigation_path: /livingroom-scenes/dashboard

      - type: custom:button-card
        entity: light.living_room_lights
        view_layout:
          grid-column: 1 / 3
          grid-row: 2 / 4
        name: Living Room
        template: default
        tap_action:
          action: call-service
          service: script.living_room_light_toggle
          service_data: 
            light_id: light.living_room_lights
            transition: 1
        double_tap_action:
          action: call-service
          service: browser_mod.popup
          service_data:
            title: Living Room Lights
            card:
              type: entities
              show_header_toggle: false
              entities:
                - light.living_room_entry
                - light.living_room_front
                - light.living_room_back
            hide_header: true
            deviceId:
              - this

      - type: custom:button-card
        entity: binary_sensor.zse40_living_room_motion
        view_layout:
          grid-column: 3 / 5
          grid-row: 2 / 4
        name: Living Room
        template: sensor

      - type: custom:button-card
        entity: sensor.zse40_living_room_temperature
        view_layout:
          grid-column: 5 / 7
          grid-row: 2 / 4
        name: Living Room
        template: temperature

      - type: custom:vertical-stack-in-card
        view_layout:
          grid-column: 7 / 9
          grid-row: 2 / 4
        cards:
          - type: markdown
            style: |
              ha-card {
                height: 40px;
              }
            content: >
              Living Room

          - type: custom:button-card
            name: Normal
            entity: scene.living_room_normal
            template: scene_button

          - type: custom:button-card
            name: Low
            entity: scene.living_room_low
            template: scene_button

          - type: custom:button-card
            name: Dim
            entity: scene.living_room_dim
            template: scene_button

      - type: custom:button-card
        entity: light.dining_room_lights
        view_layout:
          grid-column: 1 / 3
          grid-row: 4 / 6
        name: Dining Room
        template: default
        tap_action:
          action: call-service
          service: script.living_room_light_toggle
          service_data: 
            light_id: light.dining_room_lights
            transition: 1

      - type: custom:button-card
        entity: binary_sensor.zp3111_kitchen_motion
        view_layout:
          grid-column: 3 / 5
          grid-row: 4 / 6
        name: Kitchen
        template: sensor

      - type: custom:button-card
        entity: sensor.zp3111_kitchen_temperature
        view_layout:
          grid-column: 5 / 7
          grid-row: 4 / 6
        name: Kitchen
        template: temperature

      - type: custom:vertical-stack-in-card
        view_layout:
          grid-column: 7 / 9
          grid-row: 4 / 6
        cards:
          - type: markdown
            style: |
              ha-card {
                height: 44px;
              }
            content: >
              Dining Room

          - type: custom:button-card
            name: Normal
            entity: scene.dining_room_normal
            template: scene_button

          - type: custom:button-card
            name: Low
            entity: scene.dining_room_low
            template: scene_button

          - type: custom:button-card
            name: Dim
            entity: scene.dining_room_dim
            template: scene_button

      - type: custom:button-card
        entity: weather.owm
        view_layout:
          grid-column: 9 / 14
          grid-row: 2 / 4
        name: Weather
        template: weather

      - type: custom:button-card
        entity: input_select.ht_lighting_mode
        view_layout:
          grid-column: 9 / 14
          grid-row: 4 / 5
        icon: mdi:movie-filter
        tap_action:
          action: call-service
          service: input_select.select_next
          service_data:
            entity_id: input_select.ht_lighting_mode
        show_state: true
        state:
          - value: Disabled
            color: rgb(176, 176, 176)
          - value: Dimmed
            color: rgb(163, 146, 60)
          - value: Normal
            color: rgb(222, 207, 44)
        styles:
          card:
            - height: 70px
          grid:
            - grid-template-areas: '"i n" "i s"'
            - grid-template-columns: 1fr 2fr
            - grid-template-rows: 1fr 1fr
          name:
            - justify-self: start
          state:
            - justify-self: start
            - font-weight: lighter

      - type: custom:button-card
        entity: script.living_room_sunrise
        view_layout:
          grid-column: 9 / 14
          grid-row: 5 / 6
        icon: mdi:sun
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.living_room_sunrise
        styles:
          card:
            - height: 70px
          grid:
            - grid-template-areas: '"i n"'
            - grid-template-columns: 1fr 2fr
            - grid-template-rows: 1fr
          name:
            - justify-self: start
          state:
            - justify-self: start
            - font-weight: lighter

      # - type: custom:button-card
      #   entity: switch.christmas_tree
      #   view_layout:
      #     grid-column: 1 / 3
      #     grid-row: 6 / 8
      #   name: Christmas Tree
      #   template: default

#              - type: custom:button-card
#                entity: script.ht_turn_on
#                view_layout:
#                  grid-column: 1 / 3
#                  grid-row: 6 / 9
#                icon: mdi:cast
#                name: Netflix
#                tap_action:
#                  action: call-service
#                  service: script.ht_turn_on
#                  service_data:
#                    source: Netflix
#                styles:
#                  card:
#                    - height: 70px
#                  grid:
#                    - grid-template-areas: '"i n"'
#                    - grid-template-columns: 1fr 2fr
#                    - grid-template-rows: 1fr
#                  name:
#                    - justify-self: start
#                  state:
#                    - justify-self: start
#                    - font-weight: lighter

#              - type: custom:button-card
#                entity: script.ht_turn_on
#                view_layout:
#                  grid-column: 3 / 5
#                  grid-row: 6 / 9
#                icon: mdi:cast
#                name: Discovery+
#                tap_action:
#                  action: call-service
#                  service: script.ht_turn_on
#                  service_data:
#                    source: discovery plus
#                styles:
#                  card:
#                    - height: 70px
#                  grid:
#                    - grid-template-areas: '"i n"'
#                    - grid-template-columns: 1fr 2fr
#                    - grid-template-rows: 1fr
#                  name:
#                    - justify-self: start
#                  state:
#                    - justify-self: start
#                    - font-weight: lighter

#              - type: custom:button-card
#                entity: script.ht_turn_on
#                view_layout:
#                  grid-column: 5 / 7
#                  grid-row: 6 / 9
#                icon: mdi:cast
#                name: Jellyfin
#                tap_action:
#                  action: call-service
#                  service: script.ht_turn_on
#                  service_data:
#                    source: Jellyfin Beta
#                styles:
#                  card:
#                    - height: 70px
#                  grid:
#                    - grid-template-areas: '"i n"'
#                    - grid-template-columns: 1fr 2fr
#                    - grid-template-rows: 1fr
#                  name:
#                    - justify-self: start
#                  state:
#                    - justify-self: start
#                    - font-weight: lighter

      - type: custom:button-card
        entity: script.ht_turn_on
        view_layout:
          grid-column: 7 / 9
          grid-row: 6 / 9
        icon: mdi:cast
        name: Evening Lights
        tap_action:
          action: call-service
          service: scene.turn_on
          service_data:
            entity_id: "scene.evening"
            transition: "5"
        styles:
          card:
            - height: 70px
          grid:
            - grid-template-areas: '"i n"'
            - grid-template-columns: 1fr 2fr
            - grid-template-rows: 1fr
          name:
            - justify-self: start
          state:
            - justify-self: start
            - font-weight: lighter
